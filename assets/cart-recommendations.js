if(!customElements.get("cart-recommendations")){class a extends HTMLElement{constructor(){super(),this.cart=document.querySelector("cart-main"),this.recommendations=!!this.getAttribute("data-recommendations"),this.container=this.querySelector(".swiper-wrapper"),this.render_section_id="api-product-recommendations"+(this.cart?"-atc":""),this.fetchMultipleRecommendations(),this.cart&&document.addEventListener("cart:updated",t=>{t.detail&&this.update(t.detail)})}async fetchMultipleRecommendations(){var t=this.dataset.productIds.split(",").map(t=>{t=`${window.routes.product_recommendations_url}?product_id=${t}&limit=${this.dataset.limit}&intent=${this.dataset.recommendations}&section_id=`+this.render_section_id;return fetch(t).then(t=>t.text())}),e=[];for(const r of await Promise.all(t)){var i=document.createElement("div"),i=(i.innerHTML=r,i.querySelector("#shopify-section-"+this.render_section_id));i&&i.innerHTML.trim().length&&e.push(i.innerHTML)}t=e.flatMap(t=>{return t.split(/<div class="swiper-slide">|<\/div class="swiper-slide">/).filter(t=>t.trim().length).map(t=>t.trim())});const s=[];this.container.innerHTML="",t.forEach(t=>{var e=t.match(/data-product-id="(\d+)"/)[1];s.includes(e)||(this.container.innerHTML+=t='<div class="swiper-slide">'+t+"</div>",s.push(e))}),this.formatReviewsCount(),s.length||(this.closest(".section").style.display="none")}update(t){t=t.map(t=>String(t.product_id));this.dataset.productIds=t,this.dataset.limit=t.length*this.dataset.baseLimit<8?Math.ceil(8/t.length):this.dataset.baseLimit,this.fetchMultipleRecommendations()}formatReviewsCount(){this.container.querySelectorAll(".jdgm-prev-badge__text").forEach(t=>{var e=t.innerHTML.replace("reviews","review").split(" review");t.innerHTML=`(${e[0].replace(/\s/g,"")})`,t.style.visibility="visible"})}}customElements.define("cart-recommendations",a)}