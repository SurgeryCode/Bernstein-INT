if(!customElements.get("predictive-search")){class a extends HTMLElement{constructor(){super(),window.predictiveSearchBind||(this.is_opened=!1,this.input=document.querySelector('input[name="q"]'),this.results=this.querySelector(".predictive-search__grid"),this.results_empty=this.querySelector(".predictive-search__empty"),this.terms=this.querySelectorAll("[data-search-terms]"),this.button=this.querySelector(".predictive-search__button"),this.header=document.querySelector(".header"),this.count=this.querySelector("[data-search-results]"),this.speed=300,this.scrollbar=void 0,this.categories=this.querySelectorAll(".predictive-search [data-search-category]"),this.input.addEventListener("keypress",()=>{clearTimeout(this.timeout)}),this.input.addEventListener("input",e=>{this.open(),this.terms.forEach(e=>e.innerText=this.input.value),this.categories.forEach(e=>e.style.display="none"),this.timeout=setTimeout(()=>{this.search(this.input.value)},500)}),this.scrollbar=new PerfectScrollbar(this.querySelector(".predictive-search__content-inner"),{suppressScrollX:!0,wheelPropagation:!1,swipeEasing:!0,minScrollbarLength:0}),new ResizeObserver(e=>{this.scrollbar.update()}).observe(this.results),window.addEventListener("closePredictiveSearch",()=>{this.close()}),document.querySelector("main").addEventListener("click",()=>{this.close()}),window.predictiveSearchBind=!0)}search(e){this.results.innerHTML="",this.results.style.display="grid",this.button.style.display="none",this.results_empty.style.display="none",this.categories.forEach(e=>e.style.display="none"),this.button.querySelector("a").href=routes.search_url+"?type=product&q="+this.input.value,fetch(`${routes.search_url}?type=product&q=${this.input.value}&view=predictive`).then(e=>e.text()).then(e=>{var t;this.filterCategories(),10<e.length?((t=document.createElement("div")).innerHTML=e,this.results.innerHTML=t.querySelector("[data-results]").innerHTML,this.button.style.display="block",this.count.innerText=t.querySelector("[data-results]").getAttribute("data-results")):0<this.input.value.length?(this.results.style.display="none",this.button.style.display="none",this.results_empty.style.display="block"):(this.close(),this.categories.forEach(e=>e.style.display="none"),this.results.innerHTML="",this.results.style.block="none",this.button.style.display="none",this.results_empty.style.display="none"),this.formatReviewsCount()})}filterCategories(){this.categories.forEach(e=>{var t=e.getAttribute("data-search-category").toLowerCase(),s=this.input.value.toLowerCase();-1!=t.indexOf(s)?e.style.display="inline-flex":e.style.display="none"})}open(){this.is_opened||(document.body.classList.add("hide-badges"),window.dispatchEvent(new CustomEvent("closeMegaMenu")),this.slideDown(),this.header.classList.add("header--force-lighter"),setTimeout(()=>{this.classList.add("predictive-search--open")}),setTimeout(()=>{document.body.classList.add("hide-badges")},100),this.is_opened=!0)}close(){this.is_opened&&(this.header.classList.remove("header--force-lighter"),this.slideUp(),this.classList.remove("predictive--open"),setTimeout(()=>{window.dispatchEvent(new CustomEvent("badgesScroll"))},300),this.is_opened=!1)}slideUp(){this.style.transitionDuration=this.speed+"ms",this.style.height=this.offsetHeight+"px",this.offsetHeight,this.style.overflow="hidden",this.style.height=0,window.setTimeout(()=>{this.style.display="none",this.style.removeProperty("height"),this.style.removeProperty("overflow"),this.style.removeProperty("transition-duration")},this.speed)}slideDown(){this.style.removeProperty("display");let e=window.getComputedStyle(this).display,t=("none"===e&&(e="block"),this.style.display=e,this.offsetHeight);this.style.overflow="hidden",this.style.height=0,this.style.transitionDuration=this.speed+"ms",setTimeout(()=>{this.style.height=t+"px"}),window.setTimeout(()=>{this.style.removeProperty("height"),this.style.removeProperty("overflow"),this.style.removeProperty("transition-duration")},this.speed)}formatReviewsCount(){this.results.querySelectorAll(".jdgm-prev-badge__text").forEach(e=>{var t=e.innerHTML.replace("reviews","review").split(" review");e.innerHTML=`(${t[0].replace(/\s/g,"")})`,e.style.visibility="visible"})}}customElements.define("predictive-search",a)}