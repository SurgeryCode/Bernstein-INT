if(!customElements.get("upsell-item")){class a extends HTMLElement{constructor(){super(),this.variant=this.getAttribute("data-variant"),this.warranty_id=this.getAttribute("data-warranty-id"),this.warranty_name=this.getAttribute("data-warranty-name"),this.warranty_value=this.getAttribute("data-warranty-value"),this.button=this.querySelector(".upsell__button"),this.button.addEventListener("click",()=>{var t=this.button.getAttribute("data-action");"add-to-cart"==t&&this.addToCart(),"add-to-bundle"==t&&this.addToBundle(),"remove-from-cart"==t&&this.removeFromCart(),"remove-from-bundle"==t&&this.removeFromBundle(),"add-to-configurator"==t&&this.updateConfigurator(!0),"remove-from-configurator"==t&&this.updateConfigurator(!1),"add-warranty"==t&&this.updateWarranty(!0),"remove-warranty"==t&&this.updateWarranty(!1)});const t=this.querySelector(".upsell__item-expand button"),e=this.querySelector(".upsell__item-description");t&&t.addEventListener("click",()=>{"false"==t.getAttribute("aria-expanded")?(e.style.display="flex",t.setAttribute("aria-expanded","true"),t.querySelector("span").innerText=window.accessibility.read_less):(e.style.display="none",t.setAttribute("aria-expanded","false"),t.querySelector("span").innerText=window.accessibility.read_more)}),window.addEventListener("cartCounterUpdate",()=>{this.button.classList.remove("upsell__button--loading")})}addToCart(){this.button.classList.add("upsell__button--loading");var t={items:[{id:this.variant,quantity:1}]};fetch("/cart/add.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(t=>t.json()).then(t=>{this.button.setAttribute("data-action","remove-from-cart"),this.button.classList.remove("upsell__button--loading"),this.button.setAttribute("title",window.accessibility.remove_from_cart),this.button.setAttribute("aria-label",window.accessibility.remove_from_cart),window.dispatchEvent(new CustomEvent("cartCounterUpdate"))})}removeFromCart(){this.button.classList.add("upsell__button--loading");var t={updates:{}};t.updates[this.variant]=0,fetch("/cart/update.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(t=>t.json()).then(t=>{this.button.setAttribute("data-action","add-to-cart"),this.button.classList.remove("upsell__button--loading"),this.button.setAttribute("title",window.accessibility.add_to_cart),this.button.setAttribute("aria-label",window.accessibility.add_to_cart),window.dispatchEvent(new CustomEvent("cartCounterUpdate"))})}addToBundle(){window.dispatchEvent(new CustomEvent("productComponentChange",{detail:{variant:this.variant,quantity:1}})),this.button.setAttribute("data-action","remove-from-bundle"),this.button.setAttribute("title",window.accessibility.remove_from_cart),this.button.setAttribute("aria-label",window.accessibility.remove_from_cart)}removeFromBundle(){window.dispatchEvent(new CustomEvent("productComponentChange",{detail:{variant:this.variant,quantity:0}})),this.button.setAttribute("data-action","add-to-bundle"),this.button.setAttribute("title",window.accessibility.add_to_cart),this.button.setAttribute("aria-label",window.accessibility.add_to_cart)}updateConfigurator(e){this.button.classList.add("upsell__button--loading");var t=document.querySelector("#configurator-"+this.variant);let a;t&&(e?(this.button.setAttribute("data-action","remove-from-configurator"),this.button.setAttribute("title",window.accessibility.remove_from_cart),this.button.setAttribute("aria-label",window.accessibility.remove_from_cart)):(this.button.setAttribute("data-action","add-to-configurator"),this.button.setAttribute("title",window.accessibility.add_to_cart),this.button.setAttribute("aria-label",window.accessibility.add_to_cart)),window.warrantyOptions.forEach(t=>{e?0<t.priceMod&&(a=t):0==t.priceMod&&(a=t)}),t.dispatchEvent(new CustomEvent("productConfigChange",{detail:{id:"configurator-"+this.variant,value:a.name,price_mod:a.priceMod,price_mod_money:this.formatMoney(100*a.priceMod),image:a.image}})),window.dispatchEvent(new CustomEvent("addToCartRefresh")))}updateWarranty(t){this.button.classList.add("upsell__button--loading");var e={id:!1,name:"",value:""};t?(e.id=this.warranty_id,e.name=this.warranty_name,e.value=this.warranty_value,this.button.setAttribute("data-action","remove-warranty"),this.button.setAttribute("title",window.accessibility.remove_from_cart),this.button.setAttribute("aria-label",window.accessibility.remove_from_cart)):(this.button.setAttribute("data-action","add-warranty"),this.button.setAttribute("title",window.accessibility.add_to_cart),this.button.setAttribute("aria-label",window.accessibility.add_to_cart)),window.dispatchEvent(new CustomEvent("productWarrantyChange",{detail:e}))}formatMoney(t){"string"==typeof t&&(t=t.replace(".",""));var e="",a=/\{\{\s*(\w+)\s*\}\}/,i=window.moneyFormat;function r(t,e){return void 0===t?e:t}function o(t,e,a,i){return e=r(e,2),a=r(a,","),i=r(i,"."),isNaN(t)||null==t?0:(e=(t=(t/100).toFixed(e)).split("."))[0].replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1"+a)+(e[1]?i+e[1]:"")}switch(i.match(a)[1]){case"amount":e=o(t,2);break;case"amount_no_decimals":e=o(t,0);break;case"amount_with_comma_separator":e=o(t,2,".",",");break;case"amount_no_decimals_with_comma_separator":e=o(t,0,".",",")}return i.replace(a,e)}}customElements.define("upsell-item",a)}