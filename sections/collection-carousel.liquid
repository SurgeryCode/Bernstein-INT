<link rel="stylesheet" href="{{ 'section-product-carousel.css' | asset_url }}" media="print" onload="this.media='all'">
<link rel="stylesheet" href="{{ 'component-tabs.css' | asset_url }}" media="print" onload="this.media='all'">
<noscript>
    {{ 'section-product-carousel.css' | asset_url | stylesheet_tag }}
</noscript>
<script src="{{ 'swiper.js' | asset_url }}" defer="defer"></script>
<script src="{{ 'product-carousel.js' | asset_url }}" defer="defer"></script>

<div class="container">
    {%- if section.settings.heading != blank -%}
        <div class="heading">
            <div class="heading__text {% if section.settings.heading_position == "subline" %}heading__text--reverse{% endif %}">
                <h{{ section.settings.heading_tag }} class="f-48">{{ section.settings.heading | newline_to_br }}</h{{ section.settings.heading_tag }}>
                {%- if section.settings.heading_text != blank -%}
                    <div class="richtext richtext--gray">
                        <p>{{ section.settings.heading_text | newline_to_br }}</p>
                    </div>
                {%- endif -%}
            </div>
            {%- if section.settings.link_title -%}
                <a href="{{ section.settings.link_url }}" class="text-link text-link--reverse f-14 w-medium upper spaced">
                    <span>{{ section.settings.link_title }}</span>
                </a>
            {%- endif -%}
        </div>
    {%- endif -%}

    <product-carousel class="product-carousel">
        <div class="swiper">
            <div class="swiper-container">
                <div class="swiper-wrapper">
                    {%- for block in section.blocks -%}
                        <div class="swiper-slide swiper-slide--square">
                            {%- if block.type == 'text' -%}
                                <a href="{{ block.settings.link_url }}" class="product-carousel__intro product-carousel__intro--{{ block.settings.color }}">
                                    {%- if block.settings.icon != blank -%}
                                        <img 
                                            src="{{ block.settings.icon | img_url: 'x96' }}" 
                                            width="48"
                                            height="48"
                                            alt="{{ block.settings.icon }}"
                                            loading="lazy"> 
                                    {%- else -%}
                                        {%- assign icon = block.settings.link_url.object.metafields.custom.icon | handleize -%}
                                        {%- if icon != blank -%}
                                            {%- render 'svg-collection', name: icon -%}
                                        {%- endif -%}
                                    {%- endif -%}
                                    <h3 class="f-32">{{ block.settings.heading }}</h3>
                                    {%- render 'svg-icon', name: 'arrow-right' -%}
                                </a>
                            {%- endif -%}

                            {%- if block.type == 'collection' -%}
                                {%- liquid
                                    assign color = 'normal'
                                    if block.settings.image != nil and block.settings.image_alter == nil
                                        assign color = 'black'
                                    endif
                                    if block.settings.black == nil and block.settings.image_alter != nil
                                        assign color = 'white'
                                    endif
                                -%}
                                <a href="{{ block.settings.link_url }}" class="product-carousel__collection product-carousel__collection--{{ color }}">
                                    <div class="product-carousel__collection-image">
                                        {%- if block.settings.image != nil -%}
                                            {%- render 'image', 
                                                image: block.settings.image, 
                                                sizes: '379:300,380:500',
                                                class: 'cover,background' 
                                            -%}
                                        {%- endif -%}
                                        {%- if block.settings.image_alter != nil -%}
                                            {%- render 'image', 
                                                image: block.settings.image_alter, 
                                                sizes: '379:300,380:500',
                                                class: 'cover,background,alternate' 
                                            -%}
                                        {%- endif -%}
                                    </div>
                                    {% if block.settings.description %}
                                        <div class="richtext">{{ block.settings.description }}</div>
                                    {% endif %}
                                    <h3 class="f-24">{{ block.settings.title }}</h3>
                                </a>
                            {%- endif -%}
                        </div>
                    {%- endfor -%}
                </div>
            </div>
            <div class="product-carousel__arrows">
                <button 
                    class="arrow arrow--left"
                    title="{{ 'accessibility.prev_slide' | t }}"
                    aria-label="{{ 'accessibility.prev_slide' | t }}">
                    {%- render 'svg-icon', name: 'chevron-left' -%}
                </button>
                <button 
                    class="arrow arrow--right"
                    title="{{ 'accessibility.next_slide' | t }}"
                    aria-label="{{ 'accessibility.next_slide' | t }}">
                    {%- render 'svg-icon', name: 'chevron-right' -%}
                </button>
            </div>
            <div class="swiper-scrollbar"></div>
        </div>
    </product-carousel>

    {%- if section.settings.link_title -%}
        <div class="section__read-more">
            <a href="{{ section.settings.link_url }}" class="text-link text-link--reverse f-14 w-medium upper spaced">
                <span>{{ section.settings.link_title }}</span>
            </a>
        </div>
    {%- endif -%}
</div>


{% schema %}
{
  "name": "Collection Carousel",
  "tag": "section",
  "class": "section section--product-carousel margin",
  "settings": [
    {
        "type": "textarea",
        "id": "heading",
        "label": "Heading"
    },
    {
        "type": "richtext",
        "id": "heading_text",
        "label": "Subline"
    },
    {
        "type": "select",
        "id": "heading_position",
        "label": "What should be above",
        "default": "heading",
        "options": [
            {
                "value": "heading",
                "label": "Heading"
            },
            {
                "value": "subline",
                "label": "Subline"
            }
        ]
    },
    {
        "type": "select",
        "id": "heading_tag",
        "label": "Heading tag",
        "default": "2",
        "options": [
            {
                "value": "1",
                "label": "H1"
            },
            {
                "value": "2",
                "label": "H2" 
            },
            {
                "value": "3",
                "label": "H3"
            },
            {
                "value": "4",
                "label": "H4"
            }
        ]
    },
    {
        "type": "header",
        "content": "Link"
    },
    {
        "type": "url",
        "id": "link_url",
        "label": "URL"
    },
    {
        "type": "text",
        "id": "link_title",
        "label": "Title"
    }
  ],
  "blocks": [
    {
        "type": "text",
        "name": "Text",
        "limit": 1,
        "settings": [
            {
                "type": "image_picker",
                "id": "icon",
                "label": "Icon"
            },
            {
                "type": "text",
                "id": "heading",
                "label": "Heading"
            },
            {
                "type": "url",
                "id": "link_url",
                "label": "URL"
            },
            {
                "type": "select",
                "id": "color",
                "label": "Color",
                "default": "blue",
                "options": [
                    {
                        "value": "gray",
                        "label": "gray"
                    },
                    {
                        "value": "blue",
                        "label": "petrol" 
                    }
                ]
            },
        ]
    },
    {
        "type": "collection",
        "name": "Collection",
        "settings": [
            {
                "type": "text",
                "id": "title",
                "label": "Title"
            },
            {
                "type": "richtext",
                "id": "description",
                "label": "Description"
            },
            {
                "type": "url",
                "id": "link_url",
                "label": "URL"
            },
            {
                "type": "image_picker",
                "id": "image",
                "label": "Packshot"
            },
            {
                "type": "image_picker",
                "id": "image_alter",
                "label": "Interior image"
            }
        ]
    }
  ],
  "presets": [
    {
      "name": "Collection Carousel",
      "blocks": [
        {
            "type": "text",
            "settings": {
                "heading": "Heading"
            }
        },
        {
            "type": "collection"
        }
      ]
    }
  ]
}
{% endschema %}