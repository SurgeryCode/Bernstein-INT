<link rel="stylesheet" href="{{ 'section-drawer.css' | asset_url }}" media="print" onload="this.media='all'">
<noscript>{{ 'section-drawer.css' | asset_url | stylesheet_tag }}</noscript>
<script src="{{ 'drawer.js' | asset_url }}" defer="defer"></script>

<drawer-section class="drawer" id="drawer-account" tabindex="-1">
    <div class="drawer__content">
        <button 
            title="{{ 'accessibility.close' | t }}" 
            aria-label="{{ 'accessibility.close' | t }}"
            class="drawer__close"
            data-drawer-close>
                {%- render 'svg-icon', name: 'close' -%}
        </button>

        <div class="drawer__header">
            <span class="f-48 w-bold">{{ section.settings.heading }}</span>
        </div>

        <div class="drawer__scroll">
            <div class="drawer__scroll-inner">
                {%- if customer -%}
                    <div class="drawer__account">
                        {%- render 'account-dropdown' -%}
                    </div>
                {%- else -%}
                    {%- for block in section.blocks -%}
                        <div class="drawer__account drawer__account--{{ block.type }}">
                            {%- if block.type == 'login' -%}
                                <div class="drawer__account-header">
                                    <p class="w-medium">{{ block.settings.title }}</p>
                                </div>
                                {%- render 'login-form' -%}
                            {%- endif -%}
                            {%- if block.type == 'register' -%}
                                <div class="drawer__account-header">
                                    <p class="f-24 w-bold">{{ block.settings.title }}</p>
                                    {%- if block.settings.subtitle != blank -%}
                                        <p class="w-medium gray">{{ block.settings.subtitle }}</p>
                                    {%- endif -%}
                                </div>
                                {%- if block.settings.description != blank -%}
                                    <div class="richtext richtext--gray richtext--checkify-ul-blue f-14">
                                        {{ block.settings.description }}
                                    </div>
                                {%- endif -%}
                                <a href="{{ routes.account_register_url }}" class="button button--outline button--large">
                                    {{ 'account.register.button' | t }}
                                </a>
                            {%- endif -%}
                            {%- if block.type == '@app' -%}
                                {%- render block -%}
                            {%- endif -%}
                        </div>
                    {%- endfor -%}
                {%- endif -%}
            </div>
        </div>
    </div>
</drawer-section>

{% schema %}
{
  "name": "Account Drawer",
  "tag": "div",
  "settings": [
    {
        "type": "text",
        "id": "heading",
        "label": "Heading",
        "default": "Hallo!"
    }
  ],
  "blocks": [
    {
        "type": "login",
        "name": "Login",
        "limit": 1,
        "settings": [
            {
                "type": "text",
                "id": "title",
                "label": "Title"
            }
        ]
    },
    {
        "type": "register",
        "name": "Register",
        "limit": 1,
        "settings": [
            {
                "type": "text",
                "id": "title",
                "label": "Title"
            },
            {
                "type": "textarea",
                "id": "subtitle",
                "label": "Sub Title"
            },
            {
                "type": "richtext",
                "id": "description",
                "label": "Description"
            }
        ]
    },
    {
        "type": "@app"
    }
  ]
}
{% endschema %}